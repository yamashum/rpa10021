# rpa10021
# 📝 RPAデスクトップアプリ仕様書（要件定義・設計方針）

## 1. 📌 概要

本アプリは、Python + PySide6 による **完全ローカル動作の業務向けRPAデスクトップアプリケーション**です。  
Web要素／デスクトップ要素／座標点／画像／Excel／ファイル／クリップボードの統合操作を  
ノーコードGUIから定義・実行可能です。

## 2. 🛠️ 技術構成

| 項目              | 内容                                             |
|-------------------|--------------------------------------------------|
| 開発言語           | Python 3.8〜3.12                                 |
| GUIフレームワーク | PySide6（Qtベース）                             |
| 実行形式           | ローカルアプリ（サーバレス）                    |
| 補助ライブラリ     | pyautogui, uiautomation, openpyxl, clipboard, opencv-python |

---

## 3. ✅ 基本機能一覧

### 3.1 要素取得機能

- [x] Web要素（Chrome拡張 + WebSocket経由でCSS/XPath取得）
- [x] 座標取得（クリックした画面上の位置を登録）
- [x] 画像マッチング（OpenCVによる一致位置特定）
- [x] デスクトップ要素（Windows: uiautomationでボタンやテキストを取得）
- [x] 手入力ラベル名（要素に任意の識別名を付与）

### 3.2 ステップ定義・管理

- [x] ステップ登録（クリック／入力／ファイル操作／Excel制御／分岐・ループ）
- [x] ステップ順序のドラッグ＆ドロップ並べ替え
- [x] 条件分岐（if）とループ（for）構造にネスト対応
- [x] ステップ編集／削除／保存（JSON）／読み込み

### 3.3 自動化実行

- [x] GUI上の「実行ボタン」でワークフローを順次実行
- [x] 実行ログ表示（成功／失敗／エラー理由）
- [x] エラー時のダイアログ通知
- [x] SMTP経由のメール通知（任意設定）

---

## 4. 🔄 処理アクション一覧

| アクションカテゴリ | 機能 |
|-------------------|------|
| クリック           | 座標 / 画像 / UI要素クリック |
| 入力               | キーボード入力 / クリップボード貼り付け |
| Excel操作          | openpyxlによるセル読み取り／書き込み |
| ファイル処理        | コピー／移動／削除／読込・保存 |
| 条件処理           | if文による分岐（要素有無など） |
| 繰り返し           | forループによる反復 |
| 通知               | ダイアログ表示／エラーメール送信 |
| スクリーンショット  | 指定要素や画面全体の画像保存 |

---

## 5. 🧩 拡張予定機能（Ver 2.x）

- [ ] macOS向けUI要素取得の限定対応（pyatom等）
- [ ] OCR読み取りによる要素検出（Tesseract連携）
- [ ] UI要素検出のAI強化（YOLO/OpenVINO）
- [ ] 複数条件による複雑な分岐（and/or条件）
- [ ] ロールバック処理／例外ハンドリングのGUI設定
- [ ] 複数タスク同時実行（非同期スケジューラ）

---

## 6. 💾 データ形式

- ステップ保存：`workflow.json`
- 要素保存：`elements.json`
- ログ出力：`logs/yyyymmdd_HHMM.log`

---

## 7. 🔐 セキュリティ・ポリシー

- 完全ローカル処理（ネット接続不要／通信無し）
- 外部への自動送信なし（メール通知除く）
- オープンソースとしてMITライセンスを前提

---

## 8. 🚀 利用想定シーン

- 社内申請業務の自動化
- Webフォーム定型入力
- Excel転記／帳票作成
- アプリ間のデータ転送支援
- デバッグ付き業務RPA構築支援

---

> 📦 この仕様書は、業務用の**ノーコードデスクトップRPAアプリケーション**をプロレベルで構築するための土台です。
> 実装コード／テストケース／画面設計はこの構成に基づいて進めます。
